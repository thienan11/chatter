{"ast":null,"code":"import _regeneratorRuntime from\"/Users/thienantran/Downloads/chatter/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/thienantran/Downloads/chatter/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/thienantran/Downloads/chatter/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useRef,useState}from'react';import'./App.css';// firebase sdk\nimport firebase from'firebase/compat/app';import'firebase/compat/firestore';import'firebase/compat/auth';// hooks\nimport{useAuthState}from'react-firebase-hooks/auth';import{useCollectionData}from'react-firebase-hooks/firestore';import{findAllInRenderedTree}from'react-dom/test-utils';import logo from'./images/bird (1).png';// identify project\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";firebase.initializeApp({// config\napiKey:\"AIzaSyBuc9CrDPXhGevsGO5Jm6S68Hxa30d0nNk\",authDomain:\"superchatter-acb0a.firebaseapp.com\",projectId:\"superchatter-acb0a\",storageBucket:\"superchatter-acb0a.appspot.com\",messagingSenderId:\"723565069036\",appId:\"1:723565069036:web:f6b4afa06d651b09c1dbc9\",measurementId:\"G-M4H0FQRGWC\"});var auth=firebase.auth();var firestore=firebase.firestore();var numUsrs=firestore.collection('messages');function App(){var _useAuthState=useAuthState(auth),_useAuthState2=_slicedToArray(_useAuthState,1),user=_useAuthState2[0];// signed in, user is an object) | signed out, user is null\n// use ternary operator to check if a user is signed in or not\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"App-header\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Chatter\"}),/*#__PURE__*/_jsx(\"img\",{src:logo,alt:\"chatter icon\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"right-header\",children:/*#__PURE__*/_jsx(SignOut,{})})]}),/*#__PURE__*/_jsx(\"section\",{children:user?/*#__PURE__*/_jsx(Chat,{}):/*#__PURE__*/_jsx(SignIn,{})})]});}function SignIn(){var signInWithGoogle=function signInWithGoogle(){var provider=new firebase.auth.GoogleAuthProvider();auth.signInWithPopup(provider);};return/*#__PURE__*/_jsx(\"button\",{onClick:signInWithGoogle,className:\"sign-in\",children:\"Sign in with Google\"});}function SignOut(){// check for current user, and return a button to sign out\nreturn auth.currentUser&&/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return auth.signOut();},children:\"Sign Out\"});}function Chat(){var dummy=useRef();// reference a firestore collection (in this case, messages)\nvar messageRef=firestore.collection('messages');// query documents in the messages collection\nvar query=messageRef.orderBy('created').limit(25);// listen to data with a hook in real time\nvar _useCollectionData=useCollectionData(query,{idField:'id'}),_useCollectionData2=_slicedToArray(_useCollectionData,1),messages=_useCollectionData2[0];var _useState=useState(''),_useState2=_slicedToArray(_useState,2),formValue=_useState2[0],setFormValue=_useState2[1];var n=auth.currentUser.displayName;var sendMsg=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var _auth$currentUser,uid,photoURL;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:// prevent page refresh\ne.preventDefault();// get user id from current logged in user\n_auth$currentUser=auth.currentUser,uid=_auth$currentUser.uid,photoURL=_auth$currentUser.photoURL;// create new document in database\n_context.next=4;return messageRef.add({text:formValue,// created: firebase.firestore.FieldValue.serverTimestamp(),\ncreated:firebase.firestore.Timestamp.fromDate(new Date()),uid:uid,photoURL:photoURL,n:n});case 4:// after, set form value back to empty string\nsetFormValue('');// scroll into view whenever a user sends a message\ndummy.current.scrollIntoView({behavior:'smooth'});case 6:case\"end\":return _context.stop();}},_callee);}));return function sendMsg(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"main\",{children:[messages&&messages.map(function(msg){return/*#__PURE__*/_jsx(ChatMessage,{message:msg},msg.id);}),/*#__PURE__*/_jsx(\"span\",{ref:dummy})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:sendMsg,children:[/*#__PURE__*/_jsx(\"input\",{value:formValue,onChange:function onChange(e){return setFormValue(e.target.value);},placeholder:\"Send a message\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"\\uD83D\\uDCAC\"})]})]});}function ChatMessage(props){// find chat message child component, show actual text\nvar _props$message=props.message,text=_props$message.text,uid=_props$message.uid,photoURL=_props$message.photoURL,n=_props$message.n,created=_props$message.created;var ts=(created.seconds+created.nanoseconds/1000000000)*1000;var d=new Date(ts).toLocaleTimeString();// distinguish between messages that were sent and received\n// compare user id on firestore document and currently logged in user, if equal, current user sent them\nvar messageClass=uid===auth.currentUser.uid?'sent':'received';var tagClass=uid===auth.currentUser.uid?'sentN':'receivedN';return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"name \".concat(tagClass),children:/*#__PURE__*/_jsxs(\"p\",{children:[n,\" | \",d]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"message \".concat(messageClass),children:[/*#__PURE__*/_jsx(\"img\",{src:photoURL}),/*#__PURE__*/_jsx(\"p\",{children:text})]})]});}export default App;","map":{"version":3,"names":["React","useRef","useState","firebase","useAuthState","useCollectionData","findAllInRenderedTree","logo","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","auth","firestore","numUsrs","collection","App","_useAuthState","_useAuthState2","_slicedToArray","user","className","children","src","alt","SignOut","Chat","SignIn","signInWithGoogle","provider","GoogleAuthProvider","signInWithPopup","onClick","currentUser","signOut","dummy","messageRef","query","orderBy","limit","_useCollectionData","idField","_useCollectionData2","messages","_useState","_useState2","formValue","setFormValue","n","displayName","sendMsg","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","e","_auth$currentUser","uid","photoURL","wrap","_callee$","_context","prev","next","preventDefault","add","text","created","Timestamp","fromDate","Date","current","scrollIntoView","behavior","stop","_x","apply","arguments","map","msg","ChatMessage","message","id","ref","onSubmit","value","onChange","target","placeholder","type","props","_props$message","ts","seconds","nanoseconds","d","toLocaleTimeString","messageClass","tagClass","concat"],"sources":["/Users/thienantran/Downloads/chatter/src/App.js"],"sourcesContent":["import React, {useRef, useState} from 'react';\nimport './App.css';\n\n// firebase sdk\nimport firebase from 'firebase/compat/app';\nimport 'firebase/compat/firestore';\nimport 'firebase/compat/auth';\n\n// hooks\nimport {useAuthState} from 'react-firebase-hooks/auth';\nimport {useCollectionData} from 'react-firebase-hooks/firestore';\nimport { findAllInRenderedTree } from 'react-dom/test-utils';\n\nimport logo from './images/bird (1).png'\n\n// identify project\nfirebase.initializeApp({\n  // config\n  apiKey: \"AIzaSyBuc9CrDPXhGevsGO5Jm6S68Hxa30d0nNk\",\n  authDomain: \"superchatter-acb0a.firebaseapp.com\",\n  projectId: \"superchatter-acb0a\",\n  storageBucket: \"superchatter-acb0a.appspot.com\",\n  messagingSenderId: \"723565069036\",\n  appId: \"1:723565069036:web:f6b4afa06d651b09c1dbc9\",\n  measurementId: \"G-M4H0FQRGWC\"\n})\n\nconst auth = firebase.auth();\nconst firestore = firebase.firestore();\nconst numUsrs = firestore.collection('messages');\n\nfunction App() {\n\n  const[user] = useAuthState(auth); // signed in, user is an object) | signed out, user is null\n\n  // use ternary operator to check if a user is signed in or not\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <div>\n          <h1>Chatter</h1>\n          <img src={logo} alt=\"chatter icon\"/>\n        </div>\n\n        <div className='right-header'>\n          <SignOut/>\n        </div>\n\n      </header>\n      \n      <section>\n        {user ? <Chat /> : <SignIn />}\n      </section>\n\n    </div>\n  );\n}\n\nfunction SignIn() {\n  const signInWithGoogle = () => {\n    const provider = new firebase.auth.GoogleAuthProvider();\n    auth.signInWithPopup(provider);\n  }\n\n  return (\n    <button onClick={signInWithGoogle} className='sign-in'>Sign in with Google</button>\n  )\n}\n\nfunction SignOut() {\n  // check for current user, and return a button to sign out\n  return auth.currentUser && (\n    <button onClick={() => auth.signOut()}>Sign Out</button>\n  )\n}\n\nfunction Chat(){\n  \n  const dummy = useRef();\n\n  // reference a firestore collection (in this case, messages)\n  const messageRef = firestore.collection('messages');\n  // query documents in the messages collection\n  const query = messageRef.orderBy('created').limit(25);\n\n  // listen to data with a hook in real time\n  const[messages] = useCollectionData(query, {idField: 'id'});\n\n  const[formValue, setFormValue] = useState('');\n\n  const n = auth.currentUser.displayName;\n\n  const sendMsg = async(e) => {\n    // prevent page refresh\n    e.preventDefault();\n    // get user id from current logged in user\n    const {uid, photoURL} = auth.currentUser;\n\n    // create new document in database\n    await messageRef.add({\n      text: formValue,\n      // created: firebase.firestore.FieldValue.serverTimestamp(),\n      created: firebase.firestore.Timestamp.fromDate(new Date()),\n      uid,\n      photoURL,\n      n\n    });\n\n    // after, set form value back to empty string\n    setFormValue('');\n\n    // scroll into view whenever a user sends a message\n    dummy.current.scrollIntoView({behavior: 'smooth'});\n  }\n\n  return (\n    <>\n      <main>\n        {messages && messages.map(msg => <ChatMessage key={msg.id} message={msg} />)}\n      \n        <span ref={dummy}></span>\n\n      </main>\n    \n      <form onSubmit={sendMsg}>\n        {/* bind state to form input */}\n        <input value={formValue} onChange={(e) => setFormValue(e.target.value)} placeholder=\"Send a message\" />\n        \n        <button type=\"submit\">💬</button>\n\n      </form>\n    </>\n  )\n}\n\nfunction ChatMessage(props) {\n  // find chat message child component, show actual text\n  const {text, uid, photoURL, n, created} = props.message;\n  const ts = (created.seconds + created.nanoseconds/1000000000) * 1000;\n  const d = new Date(ts).toLocaleTimeString();\n\n  // distinguish between messages that were sent and received\n  // compare user id on firestore document and currently logged in user, if equal, current user sent them\n  const messageClass = uid === auth.currentUser.uid ? 'sent' : 'received';\n  const tagClass = uid === auth.currentUser.uid ? 'sentN' : 'receivedN';\n\n  return (\n    <>\n    <div className={`name ${tagClass}`}>\n      <p>{n} | {d}</p>\n    </div>\n    <div className={`message ${messageClass}`}>\n      <img src={photoURL}/>\n      <p>{text}</p>\n    </div>\n    </>\n  )\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}